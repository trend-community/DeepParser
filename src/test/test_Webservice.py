import unittest
from RestfulService import *


class WebserviceTest(unittest.TestCase):
    def testChart(self):
        nodes1 = """
        {"EndOffset": 7, "StartOffset": 0, "features": [], "sons": [{"EndOffset": 2, "StartOffset": 0, "features": ["0", "V", "VN9", "vi", "attrC", "vn", "send", "Commerce"], "text": "发货"}, {"EndOffset": 3, "StartOffset": 2, "features": ["phy", "0", "perOrg", "anim", "n", "N", "per", "unit"], "text": "员"}, {"EndOffset": 5, "StartOffset": 3, "features": ["Down", "0", "modJJ", "A", "emph", "situation", "nt", "attitude", "ntA", "nEmo", "sent", "bad", "passion", "xx"], "text": "严重"}, {"EndOffset": 7, "StartOffset": 5, "features": ["vi", "0", "despise", "V", "vn", "con", "sent", "VN9", "nt"], "text": "失职"}], "text": "发货员严重失职"}
        """
        orgdata = str(Graphviz.orgChart(nodes1))
        #print("{" + orgdata + "}")
        self.assertEqual(orgdata, """[['发货员严重失职', '', 'features: EndOffset :7 StartOffset :0'], [{'v': '发货0', 'f': '发货<div style="color:red; font-style:italic">V</div>'}, '发货员严重失职', 'features: 0 V VN9 vi attrC vn send Commerce EndOffset :2  StartOffset :0'], ['发货员严重失职', '', 'features: EndOffset :7 StartOffset :0'], [{'v': '员2', 'f': '员<div style="color:red; font-style:italic">N</div>'}, '发货员严重失职', 'features: phy 0 perOrg anim n N per unit EndOffset :3  StartOffset :2'], ['发货员严重失职', '', 'features: EndOffset :7 StartOffset :0'], [{'v': '严重3', 'f': '严重<div style="color:red; font-style:italic">A</div>'}, '发货员严重失职', 'features: Down 0 modJJ A emph situation nt attitude ntA nEmo sent bad passion xx EndOffset :5  StartOffset :3'], ['发货员严重失职', '', 'features: EndOffset :7 StartOffset :0'], [{'v': '失职5', 'f': '失职<div style="color:red; font-style:italic">V</div>'}, '发货员严重失职', 'features: vi 0 despise V vn con sent VN9 nt EndOffset :7  StartOffset :5']]""")

        nodes2 = """
        {"EndOffset": 20, "StartOffset": 0, "features": [], "sons": [{"EndOffset": 4, "StartOffset": 0, "features": ["thinking", "vVB", "V", "Pred", "v", "VG", "stateV", "animF", "VN9", "vJJ", "speak", "vS", "perF"], "sons": [{"EndOffset": 3, "StartOffset": 0, "features": ["thinking", "vVB", "V", "Pred", "v", "VG", "stateV", "animF", "VN9", "vJJ", "VP", "speak", "vS", "perF"], "sons": [{"EndOffset": 1, "StartOffset": 0, "features": ["thinking", "0", "vVB", "V", "Pred", "v", "VG", "stateV", "animF", "vt", "VN9", "vJJ", "VP", "speak", "vS", "perF"], "text": "说"}, {"EndOffset": 3, "StartOffset": 1, "UpperRelationship": "^.O", "features": ["nEmo", "deBuyu", "V", "Pred", "sent", "VG", "bad", "perfect", "passion", "c1clear", "N0", "freeM", "pred", "nt", "attitude", "ntA"], "sons": [{"EndOffset": 2, "StartOffset": 1, "features": ["0", "deBuyu", "V", "VG", "perfect", "c1clear", "pred", "freeM", "nt", "attitude", "ntA", "nEmo", "XP", "Pred", "sent", "bad", "passion", "N0"], "text": "错"}, {"EndOffset": 3, "StartOffset": 2, "UpperRelationship": "^.X", "features": ["0", "V0", "EX", "vac", "xC"], "text": "了"}], "text": "错了"}], "text": "说错了"}, {"EndOffset": 4, "StartOffset": 3, "UpperRelationship": "^.O", "features": ["phy", "0", "V0", "info", "equivN", "animF", "inanim", "text", "N", "speak", "freeM", "n", "perF"], "text": "话"}], "text": "说错了话"}, {"EndOffset": 5, "StartOffset": 4, "features": ["0", "punc"], "text": ","}, {"EndOffset": 9, "StartOffset": 5, "features": ["thinking", "vVB", "V", "Pred", "v", "VG", "stateV", "animF", "perfect", "VN9", "vJJ", "speak", "pred", "vS", "perF"], "sons": [{"EndOffset": 7, "StartOffset": 5, "features": ["thinking", "vVB", "V", "Pred", "v", "VG", "stateV", "animF", "perfect", "vJJ", "VP", "speak", "VN9", "pred", "vS", "perF"], "sons": [{"EndOffset": 6, "StartOffset": 5, "features": ["thinking", "0", "vVB", "XP", "V", "Pred", "v", "VG", "stateV", "animF", "vt", "perfect", "vJJ", "speak", "pred", "vS", "perF"], "text": "说"}, {"EndOffset": 7, "StartOffset": 6, "UpperRelationship": "^.X", "features": ["0", "V0", "EX", "vac", "xC"], "text": "了"}], "text": "说了"}, {"EndOffset": 9, "StartOffset": 7, "UpperRelationship": "^.O", "atom": "话语", "features": ["phy", "0", "con", "equivN", "info", "sent", "symbol", "expression", "inanim", "N", "text", "n", "nt"], "text": "错话"}], "text": "说了错话"}, {"EndOffset": 10, "StartOffset": 9, "features": ["0", "punc"], "text": ","}, {"EndOffset": 14, "StartOffset": 10, "features": ["con", "perfect", "nt", "ntA", "Pred", "sent", "sv", "V", "deBuyu", "VG", "c1clear", "pred", "freeM", "attitude", "nEmo", "bad", "passion", "N0"], "sons": [{"EndOffset": 12, "StartOffset": 10, "UpperRelationship": "^s", "features": ["attrC", "vi", "0", "V", "withWhom", "vn", "talk", "animF", "VN9", "speak", "perF"], "text": "说话"}, {"EndOffset": 14, "StartOffset": 12, "features": ["deBuyu", "V", "con", "AP", "VG", "perfect", "sv", "c1clear", "freeM", "pred", "nt", "attitude", "ntA", "nEmo", "XP", "Pred", "sent", "bad", "passion", "N0"], "sons": [{"EndOffset": 13, "StartOffset": 12, "features": ["0", "deBuyu", "V", "VG", "perfect", "c1clear", "pred", "freeM", "nt", "attitude", "ntA", "nEmo", "XP", "Pred", "sent", "bad", "passion", "N0"], "text": "错"}, {"EndOffset": 14, "StartOffset": 13, "UpperRelationship": "^.X", "features": ["0", "V0", "EX", "vac", "xC"], "text": "了"}], "text": "错了"}], "text": "说话错了"}, {"EndOffset": 15, "StartOffset": 14, "features": ["0", "punc"], "text": ","}, {"EndOffset": 17, "StartOffset": 15, "features": ["0", "vac", "EX", "xC"], "text": "话说"}, {"EndOffset": 19, "StartOffset": 17, "features": ["nEmo", "deBuyu", "V", "Pred", "sent", "VG", "bad", "perfect", "passion", "c1clear", "N0", "freeM", "pred", "nt", "attitude", "ntA"], "sons": [{"EndOffset": 18, "StartOffset": 17, "features": ["0", "deBuyu", "V", "VG", "perfect", "c1clear", "pred", "freeM", "nt", "attitude", "ntA", "nEmo", "XP", "Pred", "sent", "bad", "passion", "N0"], "text": "错"}, {"EndOffset": 19, "StartOffset": 18, "UpperRelationship": "^.X", "features": ["0", "V0", "EX", "vac", "xC"], "text": "了"}], "text": "错了"}, {"EndOffset": 20, "StartOffset": 19, "features": ["0", "OOV", "punc", "NNP"], "text": "。"}], "text": "说错了话,说了错话,说话错了,话说错了。"}
        """

        orgdata = str(Graphviz.orgChart(nodes2))
        self.assertEqual(orgdata, """[[{'v': '错1', 'f': '错<div style="color:red; font-style:italic">VG (H)</div>'}, '错了1', 'features: 0 deBuyu V VG perfect c1clear pred freeM nt attitude ntA nEmo XP Pred sent bad passion N0 EndOffset :2  StartOffset :1'], [{'v': '了2', 'f': '了<div style="color:red; font-style:italic">X</div>'}, '错了1', 'features: 0 V0 EX vac xC EndOffset :3  StartOffset :2'], [{'v': '说0', 'f': '说<div style="color:red; font-style:italic">VP (H)</div>'}, '说错了0', 'features: thinking 0 vVB V Pred v VG stateV animF vt VN9 vJJ VP speak vS perF EndOffset :1  StartOffset :0'], [{'v': '错了1', 'f': '错了<div style="color:red; font-style:italic">VG (O)</div>'}, '说错了0', 'features: nEmo deBuyu V Pred sent VG bad perfect passion c1clear N0 freeM pred nt attitude ntA EndOffset :3  StartOffset :1'], [{'v': '说错了0', 'f': '说错了<div style="color:red; font-style:italic">VP (H)</div>'}, '说错了话0', 'features: thinking vVB V Pred v VG stateV animF VN9 vJJ VP speak vS perF EndOffset :3  StartOffset :0'], [{'v': '话3', 'f': '话<div style="color:red; font-style:italic">N (O)</div>'}, '说错了话0', 'features: phy 0 V0 info equivN animF inanim text N speak freeM n perF EndOffset :4  StartOffset :3'], [{'v': '说5', 'f': '说<div style="color:red; font-style:italic">VG (H)</div>'}, '说了5', 'features: thinking 0 vVB XP V Pred v VG stateV animF vt perfect vJJ speak pred vS perF EndOffset :6  StartOffset :5'], [{'v': '了6', 'f': '了<div style="color:red; font-style:italic">X</div>'}, '说了5', 'features: 0 V0 EX vac xC EndOffset :7  StartOffset :6'], [{'v': '说了5', 'f': '说了<div style="color:red; font-style:italic">VP (H)</div>'}, '说了错话5', 'features: thinking vVB V Pred v VG stateV animF perfect vJJ VP speak VN9 pred vS perF EndOffset :7  StartOffset :5'], [{'v': '错话7', 'f': '错话<div style="color:red; font-style:italic">N (O)</div>'}, '说了错话5', 'features: phy 0 con equivN info sent symbol expression inanim N text n nt EndOffset :9  StartOffset :7'], [{'v': '错12', 'f': '错<div style="color:red; font-style:italic">VG (H)</div>'}, '错了12', 'features: 0 deBuyu V VG perfect c1clear pred freeM nt attitude ntA nEmo XP Pred sent bad passion N0 EndOffset :13  StartOffset :12'], [{'v': '了13', 'f': '了<div style="color:red; font-style:italic">X</div>'}, '错了12', 'features: 0 V0 EX vac xC EndOffset :14  StartOffset :13'], [{'v': '说话10', 'f': '说话<div style="color:red; font-style:italic">V (^s)</div>'}, '说话错了10', 'features: attrC vi 0 V withWhom vn talk animF VN9 speak perF EndOffset :12  StartOffset :10'], [{'v': '错了12', 'f': '错了<div style="color:red; font-style:italic">AP (H)</div>'}, '说话错了10', 'features: deBuyu V con AP VG perfect sv c1clear freeM pred nt attitude ntA nEmo XP Pred sent bad passion N0 EndOffset :14  StartOffset :12'], [{'v': '错17', 'f': '错<div style="color:red; font-style:italic">VG (H)</div>'}, '错了17', 'features: 0 deBuyu V VG perfect c1clear pred freeM nt attitude ntA nEmo XP Pred sent bad passion N0 EndOffset :18  StartOffset :17'], [{'v': '了18', 'f': '了<div style="color:red; font-style:italic">X</div>'}, '错了17', 'features: 0 V0 EX vac xC EndOffset :19  StartOffset :18'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': '说错了话0', 'f': '说错了话<div style="color:red; font-style:italic">VG</div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: thinking vVB V Pred v VG stateV animF VN9 vJJ speak vS perF EndOffset :4  StartOffset :0'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': ',4', 'f': ',<div style="color:red; font-style:italic"></div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: 0 punc EndOffset :5  StartOffset :4'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': '说了错话5', 'f': '说了错话<div style="color:red; font-style:italic">VG</div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: thinking vVB V Pred v VG stateV animF perfect VN9 vJJ speak pred vS perF EndOffset :9  StartOffset :5'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': ',9', 'f': ',<div style="color:red; font-style:italic"></div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: 0 punc EndOffset :10  StartOffset :9'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': '说话错了10', 'f': '说话错了<div style="color:red; font-style:italic">VG</div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: con perfect nt ntA Pred sent sv V deBuyu VG c1clear pred freeM attitude nEmo bad passion N0 EndOffset :14  StartOffset :10'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': ',14', 'f': ',<div style="color:red; font-style:italic"></div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: 0 punc EndOffset :15  StartOffset :14'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': '话说15', 'f': '话说<div style="color:red; font-style:italic"></div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: 0 vac EX xC EndOffset :17  StartOffset :15'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': '错了17', 'f': '错了<div style="color:red; font-style:italic">VG</div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: nEmo deBuyu V Pred sent VG bad perfect passion c1clear N0 freeM pred nt attitude ntA EndOffset :19  StartOffset :17'], ['说错了话,说了错话,说话错了,话说错了。', '', 'features: EndOffset :20 StartOffset :0'], [{'v': '。19', 'f': '。<div style="color:red; font-style:italic"></div>'}, '说错了话,说了错话,说话错了,话说错了。', 'features: 0 OOV punc NNP EndOffset :20  StartOffset :19']]""")
